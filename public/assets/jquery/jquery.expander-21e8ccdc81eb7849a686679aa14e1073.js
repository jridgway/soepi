/*
 * jQuery Expander plugin
 * Version 0.4  (12/09/2008)
 * @requires jQuery v1.1.1+
 *
 * Dual licensed under the MIT and GPL licenses:
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.gnu.org/licenses/gpl.html
 *
 */
(function(a){a.fn.expander=function(b){function e(a){a.hide().prev("span.read-more").show()}function f(a,b){a.collapseTimer&&(d=setTimeout(function(){e(b),a.onCollapse(b.parent(),!1)},a.collapseTimer))}function g(a){return a.replace(/\//,"")}var c=a.extend({},a.fn.expander.defaults,b),d;return this.each(function(){var b=a(this),h=a.meta?a.extend({},c,b.data()):c,i,j,k,l=b.html(),m=l.slice(0,h.slicePoint).replace(/\w+$/,"");j=m.match(/<\w[^>]*>/g),j&&(m=l.slice(0,h.slicePoint+j.join("").length).replace(/\w+$/,"")),m.lastIndexOf("<")>m.lastIndexOf(">")&&(m=m.slice(0,m.lastIndexOf("<")));var n=l.slice(m.length);if(!a("span.details",this).length){if(n.replace(/\s+$/,"").split(" ").length<h.widow)return;if(n.indexOf("</")>-1){k=n.match(/<(\/)?[^>]*>/g);for(var o=0;o<k.length;o++)if(k[o].indexOf("</")>-1){var p,q=!1;for(var r=0;r<o;r++)p=k[r].slice(0,k[r].indexOf(" ")).replace(/(\w)$/,"$1>"),p==g(k[o])&&(q=!0);if(!q){m=m+k[o];var s=!1;for(var t=j.length-1;t>=0;t--)j[t].slice(0,j[t].indexOf(" ")).replace(/(\w)$/,"$1>")==g(k[o])&&s==!1&&(i=i?j[t]+i:j[t],s=!0)}}n=i&&i+n||n}b.html([m,'<span class="read-more">',h.expandPrefix,'<a href="#">',h.expandText,"</a>","</span>",'<span class="details">',n,"</span>"].join(""))}var u=a("span.details",this),v=a("span.read-more",this);u.hide(),v.find("a").click(function(){return v.hide(),h.expandEffect==="show"&&!h.expandSpeed?(h.beforeExpand(b),u.show(),h.afterExpand(b),f(h,u)):(h.beforeExpand(b),u[h.expandEffect](h.expandSpeed,function(){u.css({zoom:""}),h.afterExpand(b),f(h,u)})),!1}),h.userCollapse&&(b.find("span.details").append('<span class="re-collapse">'+h.userCollapsePrefix+'<a href="#">'+h.userCollapseText+"</a></span>"),b.find("span.re-collapse a").click(function(){clearTimeout(d);var c=a(this).parents("span.details");return e(c),h.onCollapse(b,!0),!1}))})},a.fn.expander.defaults={slicePoint:100,widow:4,expandText:"read more",expandPrefix:"&hellip; ",collapseTimer:0,expandEffect:"fadeIn",expandSpeed:"",userCollapse:!0,userCollapseText:"[collapse expanded text]",userCollapsePrefix:" ",beforeExpand:function(a){},afterExpand:function(a){},onCollapse:function(a,b){}}})(jQuery)